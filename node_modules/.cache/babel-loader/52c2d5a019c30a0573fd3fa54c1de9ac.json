{"ast":null,"code":"import _slicedToArray from\"/Users/mohant/Documents/Learning/react-chat-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// Import the functions from the SDKs\nimport React,{useState}from'react';import{db,auth}from'../firebase/firebase';import firebase from'firebase/compat/app';import{getStorage,ref,getDownloadURL,uploadBytesResumable}from\"firebase/storage\";import{Input,Button}from'@mui/material/';import{Picker}from\"emoji-mart\";import\"emoji-mart/css/emoji-mart.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SendMessage=function SendMessage(_ref){var scroll=_ref.scroll;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showEmojis=_useState4[0],setShowEmojis=_useState4[1];var storage=getStorage();// Add emojis function\nvar addEmoji=function addEmoji(e){var sym=e.unified.split(\"-\");var codesArray=[];sym.forEach(function(el){return codesArray.push(\"0x\"+el);});var emoji=String.fromCodePoint.apply(String,codesArray);setInput(input+emoji);};// form on submit send message function \nvar sendMessage=function sendMessage(e){// if(input.trim().length === 0) {\n//     return;\n// }\ne.preventDefault();var _auth$currentUser=auth.currentUser,uid=_auth$currentUser.uid,photoURL=_auth$currentUser.photoURL;var uploadFiles=function uploadFiles(file){var storageRef=ref(storage,file.name);var uploadTask=uploadBytesResumable(storageRef,file);// Register three observers:\n// 1. 'state_changed' observer, called any time the state changes\n// 2. Error observer, called on failure\n// 3. Completion observer, called on successful completion\nuploadTask.on('state_changed',function(snapshot){// Observe state change events such as progress, pause, and resume\n// Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\n// const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n// console.log('Upload is ' + progress + '% done');\n// switch (snapshot.state) {\n// case 'paused':\n//     console.log('Upload is paused');\n//     break;\n// case 'running':\n//     console.log('Upload is running');\n//     break;\n// }\n},function(error){// Handle unsuccessful uploads\n},function(){// Handle successful uploads on complete\n// For instance, get the download URL: https://firebasestorage.googleapis.com/...\ngetDownloadURL(uploadTask.snapshot.ref).then(function(downloadURL){db.collection('messages').add({photoURL:photoURL,downloadURL:downloadURL,uid:uid,createdAt:firebase.firestore.FieldValue.serverTimestamp()});setInput('');scroll.current.scrollIntoView({behavior:'smooth'});});});};var file=e.target[0].files[0];if(file){uploadFiles(file);}//add the form details to the database\nif(input.trim().length!==0){db.collection('messages').add({text:input,photoURL:photoURL,uid:uid,createdAt:firebase.firestore.FieldValue.serverTimestamp()});setInput('');scroll.current.scrollIntoView({behavior:'smooth'});}};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"form\",{onSubmit:sendMessage,children:/*#__PURE__*/_jsxs(\"div\",{className:\"sendMsg\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\"}),/*#__PURE__*/_jsx(Button,{className:\"button\",onClick:function onClick(){return setShowEmojis(!showEmojis);},children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"icon\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\",\"stroke-width\":\"2\",d:\"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"})})}),/*#__PURE__*/_jsx(Input,{style:{width:'78%',fontSize:'15px',fontWeight:'550',marginLeft:'5px',marginBottom:'-3px'},placeholder:\"Message...\",type:\"text\",value:input,onChange:function onChange(e){return setInput(e.target.value);}}),/*#__PURE__*/_jsx(Button,{style:{width:'18%',fontSize:'15px',fontWeight:'550',margin:'4px 5% -13px 5%',maxWidth:'200px'},type:\"submit\",children:\"Send\"}),showEmojis&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Picker,{onSelect:addEmoji})})]})})});};export default SendMessage;","map":{"version":3,"sources":["/Users/mohant/Documents/Learning/react-chat-app/src/components/SendMessage.js"],"names":["React","useState","db","auth","firebase","getStorage","ref","getDownloadURL","uploadBytesResumable","Input","Button","Picker","SendMessage","scroll","input","setInput","showEmojis","setShowEmojis","storage","addEmoji","e","sym","unified","split","codesArray","forEach","el","push","emoji","String","fromCodePoint","sendMessage","preventDefault","currentUser","uid","photoURL","uploadFiles","file","storageRef","name","uploadTask","on","snapshot","error","then","downloadURL","collection","add","createdAt","firestore","FieldValue","serverTimestamp","current","scrollIntoView","behavior","target","files","trim","length","text","width","fontSize","fontWeight","marginLeft","marginBottom","value","margin","maxWidth"],"mappings":"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","sourcesContent":["// Import the functions from the SDKs\n\nimport React, { useState } from 'react'\nimport { db, auth } from '../firebase/firebase';\nimport firebase from 'firebase/compat/app';\n\nimport { getStorage, ref, getDownloadURL, uploadBytesResumable } from \"firebase/storage\";\n\nimport { Input, Button } from '@mui/material/'\n\nimport { Picker } from \"emoji-mart\";\nimport \"emoji-mart/css/emoji-mart.css\";\n\n\nconst SendMessage = ({ scroll }) => {\n\n    const [input, setInput] = useState(\"\");\n    const [showEmojis, setShowEmojis] = useState(false);\n\n    const storage = getStorage();\n\n    // Add emojis function\n\n    const addEmoji = (e) => {\n        let sym = e.unified.split(\"-\");\n        let codesArray = [];\n        sym.forEach((el) => codesArray.push(\"0x\" + el));\n        let emoji = String.fromCodePoint(...codesArray);\n        setInput(input + emoji);\n    };\n\n     // form on submit send message function \n\n    const sendMessage = (e) => {\n        \n        \n\n        // if(input.trim().length === 0) {\n        //     return;\n        // }\n\n        e.preventDefault()\n        const { uid, photoURL } = auth.currentUser\n\n        const uploadFiles = (file) => {\n            const storageRef = ref(storage, file.name);\n\n            const uploadTask = uploadBytesResumable(storageRef, file);\n\n            // Register three observers:\n            // 1. 'state_changed' observer, called any time the state changes\n            // 2. Error observer, called on failure\n            // 3. Completion observer, called on successful completion\n            uploadTask.on('state_changed', \n            (snapshot) => {\n                // Observe state change events such as progress, pause, and resume\n                // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\n                // const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n                // console.log('Upload is ' + progress + '% done');\n                // switch (snapshot.state) {\n                // case 'paused':\n                //     console.log('Upload is paused');\n                //     break;\n                // case 'running':\n                //     console.log('Upload is running');\n                //     break;\n                // }\n            }, \n            (error) => {\n                // Handle unsuccessful uploads\n            }, \n            () => {\n                // Handle successful uploads on complete\n                // For instance, get the download URL: https://firebasestorage.googleapis.com/...\n                getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {\n\n                    db.collection('messages').add({\n                        photoURL,\n                        downloadURL,\n                        uid,\n                        createdAt: firebase.firestore.FieldValue.serverTimestamp()\n                    })\n                    setInput('')\n                    scroll.current.scrollIntoView({ behavior: 'smooth' })\n                });\n            }\n            );\n        };\n        \n        \n\n        const file = e.target[0].files[0];\n        if(file) {\n            uploadFiles(file);\n        }\n\n        //add the form details to the database\n        if(input.trim().length !== 0) {\n            db.collection('messages').add({\n                text: input,\n                photoURL,\n                uid,\n                createdAt: firebase.firestore.FieldValue.serverTimestamp()\n            })\n            setInput('')\n            scroll.current.scrollIntoView({ behavior: 'smooth' })\n        }\n    };\n\n    \n    \n    \n    \n    return (\n        <div>\n            <form onSubmit={sendMessage}>\n                <div className=\"sendMsg\">\n  \n            <input type=\"file\" />\n\n\n                    <Button className=\"button\" onClick={() => setShowEmojis(!showEmojis)}>\n                        <svg\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                            className=\"icon\"\n                            fill=\"none\"\n                            viewBox=\"0 0 24 24\"\n                            stroke=\"currentColor\"\n                            >\n                            <path\n                                stroke-linecap=\"round\"\n                                stroke-linejoin=\"round\"\n                                stroke-width=\"2\"\n                                d=\"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n                            />\n                        </svg>\n                    </Button>\n                    \n                    <Input style={{ width: '78%', fontSize: '15px', fontWeight: '550', marginLeft: '5px', marginBottom: '-3px' }} placeholder='Message...' type=\"text\" \n                        value={input} onChange={(e) => setInput(e.target.value)}\n                    />\n                    \n                    <Button style={{ width: '18%', fontSize: '15px', fontWeight: '550', margin: '4px 5% -13px 5%', maxWidth: '200px'}} type=\"submit\">Send</Button>\n                    {showEmojis && (\n                        <div>\n                        <Picker onSelect={addEmoji} />\n                        </div>\n                    )}\n                </div>\n            </form>\n        </div>\n    )\n}\n\nexport default SendMessage"]},"metadata":{},"sourceType":"module"}